<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: AnimationCommon.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: AnimationCommon.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module AnimationCommon */
import React, {Component} from "react";
import PropTypes from "prop-types";

import {withComponentMixins, createComponentMixin} from "../lib/decorator-helpers";
import styles from "./AnimationCommon.scss";

/**
* Context defined by the {@link Animation} component containing animation's state.
*/
export const AnimationStatusContext = React.createContext(null);
/** Context provided by the Animation component containing animation's control
    * functions. */
export const AnimationControlContext = React.createContext(null);
/** Context provided by the Animation component containing the visualization
 * data sets produced by Data sources.
 *
 * @category Context
 *
 */
export const AnimationDataContext = React.createContext(null);

export const withAnimationControl = createComponentMixin({
    contexts: [
        {context: AnimationStatusContext, propName: 'animationStatus'},
        {context: AnimationControlContext, propName: 'animationControl'}
    ]
});

export const withAnimationStatus = createComponentMixin({
    contexts: [
        {context: AnimationStatusContext, propName: 'animationStatus'},
    ]
});

export const withAnimationData = createComponentMixin({
    contexts: [ {context: AnimationDataContext, propName: 'animationData'} ]
});



/**
 * Function
 *
 * @param Stationary visualization component.
 * @return Animated version of given visualization component.
 *
 * @function
 */
export function animated(VisualizationComp) {
    /**
     * Component wrapping visualization component, displaying an overlay.
     *
     */
    @withComponentMixins([withAnimationData, withAnimationStatus])
    class AnimatedContent extends Component {
        /**
            * Key of the Data source, from which to receive data.
            *
            * @type object
            * @property dataSourceKey
        */
        static propTypes = {
            animationStatus: PropTypes.object.isRequired,
            animationData: PropTypes.object.isRequired,
            dataSourceKey: PropTypes.string.isRequired,

            forwardRef: PropTypes.func,
        }

        constructor(props) {
            super(props);

            this.lastValidData = null;
        }

        render() {
            const {
                forwardRef,
                dataSourceKey,
                animationData,
                animationStatus,
                ...visualizationProps
            } = this.props;

            let message = null;
            let withSpinner = false;

            let data = (animationData &amp;&amp; animationData[dataSourceKey]) || this.lastValidData;

            if (data !== null) {
                this.lastValidData = data;
            }

            if (animationStatus.error) {
                message = new String(animationStatus.error);
            } else if (animationStatus.isBuffering) {
                withSpinner = true;
                message =  "Loading...";
            }

            return (
                &lt;div ref={node => this.containerNode = node} className={styles.animatedContainer}>
                    {message &amp;&amp;
                        &lt;div className={styles.loadingOverlay}>
                            &lt;div className={styles.loadingMsgContainer}>
                                {withSpinner &amp;&amp;
                                    &lt;div className={styles.loadingSpinner + " spinner-border"} role={"status"}>
                                        &lt;span className={"sr-only"}>Loading&lt;/span>
                                    &lt;/div>
                                }
                                &lt;span className={styles.loadingMsg}>{message}&lt;/span>
                            &lt;/div>
                        &lt;/div>
                    }
                    {data &amp;&amp; &lt;VisualizationComp {...visualizationProps} data={data} ref={forwardRef} />}
                &lt;/div>
            );
        }
    }

    return React.forwardRef(function AnimatedVisualization(props, ref) {
        return &lt;AnimatedContent {...props} forwardRef={ref} />;
    });
}

export * from '../lib/animation-interpolations';
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AnimationCommon.html">AnimationCommon</a></li></ul><h3>Classes</h3><ul><li><a href="module-AnimationCommon-AnimatedContent.html">AnimatedContent</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Dec 20 2020 20:28:56 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
