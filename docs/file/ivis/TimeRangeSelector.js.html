<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">ivis/TimeRangeSelector.js | ivis-core</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Just to make my dev environment a little easier to use."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="ivis-core"><meta property="twitter:description" content="Just to make my dev environment a little easier to use."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/dburian/ivis-core"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/AreaChart.js~AreaChart.html">AreaChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/BarChart.js~StaticBarChart.html">StaticBarChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/BubblePlot.js~BubblePlot.html">BubblePlot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/DataAccess.js~DataAccess.html">DataAccess</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/DataAccess.js~DataAccessSession.html">DataAccessSession</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/DataAccess.js~TimeSeriesPointProvider.html">TimeSeriesPointProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/DataAccess.js~TimeSeriesProvider.html">TimeSeriesProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/DataAccess.js~TimeSeriesSummaryProvider.html">TimeSeriesSummaryProvider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/DataPathApproximator.js~DataPathApproximator.html">DataPathApproximator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/FrequencyBarChart.js~FrequencyBarChart.html">FrequencyBarChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/FrequencyDataLoader.js~FrequencyDataLoader.html">FrequencyDataLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/FrequencyPieChart.js~FrequencyPieChart.html">FrequencyPieChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/HeatmapChart.js~HeatmapChart.html">HeatmapChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/HistogramChart.js~HistogramChart.html">HistogramChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/Legend.js~Legend.html">Legend</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/Legend.js~StaticLegend.html">StaticLegend</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/LineChart.js~LineChart.html">LineChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/LineChartBase.js~LineChartBase.html">LineChartBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/LiveAnimation.js~LiveAnimation.html">LiveAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/MinMaxLoader.js~MinMaxLoader.html">MinMaxLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/OnOffAreaChart.js~OnOffAreaChart.html">OnOffAreaChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/PanelConfig.js~Configurator.html">Configurator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/PanelConfig.js~PanelConfigAccess.html">PanelConfigAccess</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/PanelConfig.js~PdfExportDialog.html">PdfExportDialog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/PanelConfig.js~PermanentLinkDialog.html">PermanentLinkDialog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/PanelConfig.js~SaveDialog.html">SaveDialog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/PieChart.js~StaticPieChart.html">StaticPieChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/RecordedAnimation.js~RecordedAnimation.html">RecordedAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/Records.js~Records.html">Records</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/SVG.js~SVG.html">SVG</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/ScatterPlot.js~ScatterPlot.html">ScatterPlot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/ScatterPlotBase.js~ScatterPlotBase.html">ScatterPlotBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/Selector.js~SignalSelector.html">SignalSelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/Selector.js~StaticSignalSelector.html">StaticSignalSelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeBasedChartBase.js~TimeBasedChartBase.html">TimeBasedChartBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeContext.js~TimeContext.html">TimeContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeInterval.js~IntervalAbsolute.html">IntervalAbsolute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeInterval.js~IntervalHistory.html">IntervalHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeInterval.js~IntervalSpec.html">IntervalSpec</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeInterval.js~TimeInterval.html">TimeInterval</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeRangeSelector.js~PredefTimeRangeSelector.html">PredefTimeRangeSelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/TimeRangeSelector.js~TimeRangeSelector.html">TimeRangeSelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/Tooltip.js~Tooltip.html">Tooltip</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-animated">animated</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-forAggs">forAggs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getAxisIdx">getAxisIdx</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lineWithPointsOnHover">lineWithPointsOnHover</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lineWithoutPoints">lineWithoutPoints</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lineWithoutPointsAndPointsOnNoAggregation">lineWithoutPointsAndPointsOnNoAggregation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-nolineWithPointsAlways">nolineWithPointsAlways</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createBase">createBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isSignalVisible">isSignalVisible</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-intervalAccessMixin">intervalAccessMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-defaultGetMinAggregationInterval">defaultGetMinAggregationInterval</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ModifyColorCopy">ModifyColorCopy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-WheelDelta">WheelDelta</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-brushHandlesLeftRight">brushHandlesLeftRight</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-brushHandlesTopBottom">brushHandlesTopBottom</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-distance">distance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-extentWithMargin">extentWithMargin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getColorScale">getColorScale</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getExtent">getExtent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isInExtent">isInExtent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isSignalVisible">isSignalVisible</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-roundTo">roundTo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setZoomTransform">setZoomTransform</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-transitionInterpolate">transitionInterpolate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fileUrl">fileUrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AnimationControlContext">AnimationControlContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AnimationDataContext">AnimationDataContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AnimationStatusContext">AnimationStatusContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-withAnimationControl">withAnimationControl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-withAnimationData">withAnimationData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-withAnimationStatus">withAnimationStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TimeSeriesPointPredefs">TimeSeriesPointPredefs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TimeSeriesPointType">TimeSeriesPointType</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-dataAccess">dataAccess</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PointsVisibility">PointsVisibility</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pointsOnNoAggregation">pointsOnNoAggregation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PanelConfigOwnerContext">PanelConfigOwnerContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-panelConfigAccessMixin">panelConfigAccessMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-panelConfigMixin">panelConfigMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-withPanelConfig">withPanelConfig</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-panelMenuMixin">panelMenuMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LegendPosition">LegendPosition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ConfigDifference">ConfigDifference</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-RenderStatus">RenderStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TimeIntervalsContext">TimeIntervalsContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ZoomEventSources">ZoomEventSources</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-dotShapeNames">dotShapeNames</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-dotShapes">dotShapes</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#attic">attic</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/attic/BarChart.js~BarChart.html">BarChart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/attic/BarNavigator.js~LineNavigator.html">LineNavigator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/ivis/attic/LineNavigator.js~BarNavigator.html">BarNavigator</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">ivis/TimeRangeSelector.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

import React, {Component} from &quot;react&quot;;
import PropTypes
    from &quot;prop-types&quot;;
import {
    DatePicker,
    Dropdown,
    Form,
    withForm
} from &quot;../lib/form&quot;;
import styles
    from &quot;./TimeRangeSelector.scss&quot;;
import moment
    from &quot;moment&quot;;
import {
    ActionLink,
    Button,
    Icon
} from &quot;../lib/bootstrap-components&quot;;
import * as dateMath
    from &quot;../lib/datemath&quot;;
import {intervalAccessMixin} from &quot;./TimeContext&quot;;
import _
    from &quot;lodash&quot;;
import {IntervalSpec} from &quot;./TimeInterval&quot;;
import {withComponentMixins} from &quot;../lib/decorator-helpers&quot;;
import {withTranslation} from &quot;../lib/i18n&quot;;

@withComponentMixins([
    withTranslation,
    withForm,
    intervalAccessMixin()
])
export class TimeRangeSelector extends Component {
    constructor(props, context) {
        super(props, context);

        const t = props.t;

        this.state = {
            opened: false
        };

        this.refreshIntervalTypes = {
            off: { label: t(&apos;off&apos;), duration: null },
            &apos;5s&apos;: { label: t(&apos;5 seconds&apos;), duration: moment.duration(5, &apos;s&apos;) },
            &apos;10s&apos;: { label: t(&apos;10 seconds&apos;), duration: moment.duration(10, &apos;s&apos;) },
            &apos;30s&apos;: { label: t(&apos;30 seconds&apos;), duration: moment.duration(30, &apos;s&apos;) },
            &apos;1m&apos;: { label: t(&apos;1 minute&apos;), duration: moment.duration(1, &apos;m&apos;) },
            &apos;5m&apos;: { label: t(&apos;5 minute&apos;), duration: moment.duration(5, &apos;m&apos;) },
            &apos;15m&apos;: { label: t(&apos;15 minutes&apos;), duration: moment.duration(15, &apos;m&apos;) },
            &apos;30m&apos;: { label: t(&apos;30 minutes&apos;), duration: moment.duration(30, &apos;m&apos;) },
            &apos;1h&apos;: { label: t(&apos;1 hour&apos;), duration: moment.duration(1, &apos;h&apos;) },
            &apos;2h&apos;: { label: t(&apos;2 hours&apos;), duration: moment.duration(2, &apos;h&apos;) },
            &apos;1d&apos;: { label: t(&apos;1 day&apos;), duration: moment.duration(1, &apos;d&apos;) }
        };

        this.aggregationIntervalTypes = {
            auto: { label: t(&apos;auto&apos;), duration: null },
            off: { label: t(&apos;off&apos;), duration: moment.duration(0, &apos;s&apos;) },
            &apos;1ms&apos;: { label: t(&apos;1 millisecond&apos;), duration: moment.duration(1, &apos;ms&apos;) },
            &apos;5ms&apos;: { label: t(&apos;5 milliseconds&apos;), duration: moment.duration(5, &apos;ms&apos;) },
            &apos;10ms&apos;: { label: t(&apos;10 milliseconds&apos;), duration: moment.duration(10, &apos;ms&apos;) },
            &apos;50ms&apos;: { label: t(&apos;50 milliseconds&apos;), duration: moment.duration(50, &apos;ms&apos;) },
            &apos;100ms&apos;: { label: t(&apos;100 milliseconds&apos;), duration: moment.duration(100, &apos;ms&apos;) },
            &apos;200ms&apos;: { label: t(&apos;200 milliseconds&apos;), duration: moment.duration(200, &apos;ms&apos;) },
            &apos;500ms&apos;: { label: t(&apos;500 milliseconds&apos;), duration: moment.duration(500, &apos;ms&apos;) },
            &apos;1s&apos;: { label: t(&apos;1 second&apos;), duration: moment.duration(1, &apos;s&apos;) },
            &apos;2s&apos;: { label: t(&apos;2 seconds&apos;), duration: moment.duration(2, &apos;s&apos;) },
            &apos;5s&apos;: { label: t(&apos;5 seconds&apos;), duration: moment.duration(5, &apos;s&apos;) },
            &apos;10s&apos;: { label: t(&apos;10 seconds&apos;), duration: moment.duration(10, &apos;s&apos;) },
            &apos;15s&apos;: { label: t(&apos;15 seconds&apos;), duration: moment.duration(15, &apos;s&apos;) },
            &apos;30s&apos;: { label: t(&apos;30 seconds&apos;), duration: moment.duration(30, &apos;s&apos;) },
            &apos;1m&apos;: { label: t(&apos;1 minute&apos;), duration: moment.duration(1, &apos;m&apos;) },
            &apos;2m&apos;: { label: t(&apos;2 minutes&apos;), duration: moment.duration(2, &apos;m&apos;) },
            &apos;5m&apos;: { label: t(&apos;5 minutes&apos;), duration: moment.duration(5, &apos;m&apos;) },
            &apos;10m&apos;: { label: t(&apos;10 minutes&apos;), duration: moment.duration(10, &apos;m&apos;) },
            &apos;15m&apos;: { label: t(&apos;15 minutes&apos;), duration: moment.duration(15, &apos;m&apos;) },
            &apos;30m&apos;: { label: t(&apos;30 minutes&apos;), duration: moment.duration(30, &apos;m&apos;) },
            &apos;1h&apos;: { label: t(&apos;1 hour&apos;), duration: moment.duration(1, &apos;h&apos;) },
            &apos;2h&apos;: { label: t(&apos;2 hours&apos;), duration: moment.duration(2, &apos;h&apos;) },
            &apos;4h&apos;: { label: t(&apos;4 hours&apos;), duration: moment.duration(4, &apos;h&apos;) },
            &apos;6h&apos;: { label: t(&apos;6 hours&apos;), duration: moment.duration(6, &apos;h&apos;) },
            &apos;12h&apos;: { label: t(&apos;12 hours&apos;), duration: moment.duration(12, &apos;h&apos;) },
            &apos;1d&apos;: { label: t(&apos;1 day&apos;), duration: moment.duration(1, &apos;d&apos;) },
            &apos;2d&apos;: { label: t(&apos;2 days&apos;), duration: moment.duration(2, &apos;d&apos;) },
            &apos;5d&apos;: { label: t(&apos;5 days&apos;), duration: moment.duration(5, &apos;d&apos;) },
            &apos;1w&apos;: { label: t(&apos;1 week&apos;), duration: moment.duration(1, &apos;w&apos;) },
            &apos;2w&apos;: { label: t(&apos;2 weeks&apos;), duration: moment.duration(2, &apos;w&apos;) },
            &apos;1M&apos;: { label: t(&apos;1 month&apos;), duration: moment.duration(1, &apos;M&apos;) }
        };

        this.fixedRangeTypes = [
            [
                { from: &apos;now-2d&apos;, to: &apos;now&apos;, label: t(&apos;Last 2 days&apos;) },
                { from: &apos;now-7d&apos;, to: &apos;now&apos;, label: t(&apos;Last 7 days&apos;) },
                { from: &apos;now-30d&apos;, to: &apos;now&apos;, label: t(&apos;Last 30 days&apos;) },
                { from: &apos;now-90d&apos;, to: &apos;now&apos;, label: t(&apos;Last 90 days&apos;) },
                { from: &apos;now-6M&apos;, to: &apos;now&apos;, label: t(&apos;Last 6 months&apos;) },
                { from: &apos;now-1y&apos;, to: &apos;now&apos;, label: t(&apos;Last 1 year&apos;) },
                { from: &apos;now-2y&apos;, to: &apos;now&apos;, label: t(&apos;Last 2 years&apos;) },
                { from: &apos;now-5y&apos;, to: &apos;now&apos;, label: t(&apos;Last 5 years&apos;) }
            ],
            [
                { from: &apos;now-1d/d&apos;, to: &apos;now-1d/d&apos;, label: t(&apos;Yesterday&apos;) },
                { from: &apos;now-2d/d&apos;, to: &apos;now-2d/d&apos;, label: t(&apos;Day before yesterday&apos;) },
                { from: &apos;now-7d/d&apos;, to: &apos;now-7d/d&apos;, label: t(&apos;This day last week&apos;) },
                { from: &apos;now-1w/w&apos;, to: &apos;now-1w/w&apos;, label: t(&apos;Previous week&apos;) },
                { from: &apos;now-1M/M&apos;, to: &apos;now-1M/M&apos;, label: t(&apos;Previous month&apos;) },
                { from: &apos;now-1y/y&apos;, to: &apos;now-1y/y&apos;, label: t(&apos;Previous year&apos;) }
            ],
            [
                { from: &apos;now/d&apos;, to: &apos;now/d&apos;, label: t(&apos;Today&apos;) },
                { from: &apos;now/d&apos;, to: &apos;now&apos;, label: t(&apos;Today so far&apos;) },
                { from: &apos;now/w&apos;, to: &apos;now/w&apos;, label: t(&apos;This week&apos;) },
                { from: &apos;now/w&apos;, to: &apos;now&apos;, label: t(&apos;This week so far&apos;) },
                { from: &apos;now/M&apos;, to: &apos;now/M&apos;, label: t(&apos;This month&apos;) },
                { from: &apos;now/M&apos;, to: &apos;now&apos;, label: t(&apos;This month so far&apos;) },
                { from: &apos;now/y&apos;, to: &apos;now/y&apos;, label: t(&apos;This year&apos;) },
                { from: &apos;now/y&apos;, to: &apos;now&apos;, label: t(&apos;This year so far&apos;) }
            ],
            [
                { from: &apos;now-5m&apos;, to: &apos;now&apos;, label: t(&apos;Last 5 minutes&apos;) },
                { from: &apos;now-15m&apos;, to: &apos;now&apos;, label: t(&apos;Last 15 minutes&apos;) },
                { from: &apos;now-30m&apos;, to: &apos;now&apos;, label: t(&apos;Last 30 minutes&apos;) },
                { from: &apos;now-1h&apos;, to: &apos;now&apos;, label: t(&apos;Last 1 hour&apos;) },
                { from: &apos;now-3h&apos;, to: &apos;now&apos;, label: t(&apos;Last 3 hours&apos;) },
                { from: &apos;now-6h&apos;, to: &apos;now&apos;, label: t(&apos;Last 6 hours&apos;) },
                { from: &apos;now-12h&apos;, to: &apos;now&apos;, label: t(&apos;Last 12 hours&apos;) },
                { from: &apos;now-24h&apos;, to: &apos;now&apos;, label: t(&apos;Last 24 hours&apos;) }
            ]
        ];

        this.initForm({
            onChangeBeforeValidation: (mutStateData, key, oldValue, newValue) =&gt; {
                if (key === &apos;to&apos; || key === &apos;from&apos;) {
                    const fromStr = mutStateData.getIn([&apos;from&apos;, &apos;value&apos;]);
                    const toStr = mutStateData.getIn([&apos;to&apos;, &apos;value&apos;]);
                    const aggregationIntervalStr = mutStateData.getIn([&apos;aggregationInterval&apos;, &apos;value&apos;]);

                    const aggregationOptions = this.getAggregationOptions(fromStr, toStr);
                    if (!aggregationOptions.find(x =&gt; x.key === aggregationIntervalStr)) {
                        mutStateData.setIn([&apos;aggregationInterval&apos;, &apos;value&apos;], &apos;auto&apos;);
                    }
                }
            }
        });
    }

    static propTypes = {

    }

    refreshValuesFromIntervalSpec() {
        const intervalSpec = this.getIntervalSpec();

        this.populateFormValues({
            from: dateMath.format(intervalSpec.from),
            to: dateMath.format(intervalSpec.to),
            aggregationInterval: _.findKey(this.aggregationIntervalTypes,
                    x =&gt; x.duration === intervalSpec.aggregationInterval ||
                        (x.duration &amp;&amp; intervalSpec.aggregationInterval &amp;&amp; x.duration.toISOString() === intervalSpec.aggregationInterval.toISOString())
                ) || &apos;off&apos;,
            refreshInterval: _.findKey(this.refreshIntervalTypes,
                    x =&gt; x.duration === intervalSpec.refreshInterval ||
                        (x.duration &amp;&amp; intervalSpec.refreshInterval &amp;&amp; x.duration.toISOString() === intervalSpec.refreshInterval.toISOString())
                ) || &apos;off&apos;
        });
    }

    componentDidMount() {
        this.refreshValuesFromIntervalSpec();
    }

    componentDidUpdate(prevProps) {
        const prevIntervalSpec = this.getIntervalSpec(prevProps);

        if (prevIntervalSpec !== this.getIntervalSpec()) {
            this.refreshValuesFromIntervalSpec();
        }
    }

    localValidateFormValues(state) {
        const t = this.props.t;

        const fromStr = state.getIn([&apos;from&apos;, &apos;value&apos;]);
        const from = dateMath.parse(fromStr, false);
        if (fromStr === &apos;&apos;) {
            state.setIn([&apos;from&apos;, &apos;error&apos;], t(&apos;Date must be set&apos;));
        } else if (!from || !from.isValid()) {
            state.setIn([&apos;from&apos;, &apos;error&apos;], t(&apos;Date is invalid&apos;));
        } else {
            state.setIn([&apos;from&apos;, &apos;error&apos;], null);
        }

        const toStr = state.getIn([&apos;to&apos;, &apos;value&apos;]);
        const to = dateMath.parse(toStr, true);
        if (toStr === &apos;&apos;) {
            state.setIn([&apos;to&apos;, &apos;error&apos;], t(&apos;Date must be set&apos;));
        } else if (!to || !to.isValid()) {
            state.setIn([&apos;to&apos;, &apos;error&apos;], t(&apos;Date is invalid&apos;));
        } else {
            state.setIn([&apos;to&apos;, &apos;error&apos;], null);
        }
    }

    async submitForm() {
        if (this.isFormWithoutErrors()) {
            const from = this.getFormValue(&apos;from&apos;);
            const to = this.getFormValue(&apos;to&apos;);

            const refreshIntervalKey = this.getFormValue(&apos;refreshInterval&apos;);
            const aggregationIntervalKey = this.getFormValue(&apos;aggregationInterval&apos;);

            const spec = new IntervalSpec(
                from,
                to,
                this.aggregationIntervalTypes[aggregationIntervalKey].duration,
                this.refreshIntervalTypes[refreshIntervalKey].duration
            );

            this.getInterval().setSpec(spec);

            this.setState({
                opened: false
            });

        } else {
            this.showFormValidation();
        }
    }

    submitRange(entry) {
        const spec = new IntervalSpec(
            entry.from,
            entry.to,
            null
        );

        this.getInterval().setSpec(spec);

        this.setState({
            opened: false
        });
    }

    alignAndSetInterval(from, to) {
    }

    async zoom(factor) {
        const intv = this.getInterval();

        const abs = this.getIntervalAbsolute();

        const middle = (abs.to + abs.from) / 2;
        const halfLength = (abs.to - abs.from) * factor / 2;

        const rounded = intv.roundToMinAggregationInterval(middle - halfLength, middle + halfLength);

        const spec = new IntervalSpec(
            rounded.from,
            rounded.to,
            null
        );

        intv.setSpec(spec);
    }

    async move(factor) {
        const intv = this.getInterval();

        const abs = this.getIntervalAbsolute();

        const offset = (abs.to - abs.from) * factor;

        const rounded = intv.roundToMinAggregationInterval(abs.from + offset, abs.to + offset);

        const spec = new IntervalSpec(
            rounded.from,
            moment(rounded.from + abs.to - abs.from) // We preserve the original interval size
        );

        intv.setSpec(spec);
    }

    getDescription() {
        const intervalSpec = this.getIntervalSpec();
        const selectedKey = intervalSpec.from + &apos; to &apos; + intervalSpec.to;

        let selectedRange;
        for (const rangeColumn of this.fixedRangeTypes) {
            for (const entry of rangeColumn) {
                const key = entry.from + &apos; to &apos; + entry.to;
                if (key === selectedKey) {
                    selectedRange = entry;
                    break;
                }
            }
        }

        let description;
        if (selectedRange) {
            description = selectedRange.label;
        } else {
            const intervalAbsolute = this.getIntervalAbsolute();
            description = dateMath.format(intervalAbsolute.from) + &apos; to &apos; + dateMath.format(intervalAbsolute.to);
        }

        return description;
    }

    getAggregationOptions(fromStr, toStr) {
        let aggregationOptions;
        const absFrom = dateMath.parse(fromStr, false);
        const absTo = dateMath.parse(toStr, true);

        if (absFrom &amp;&amp; absTo &amp;&amp; absFrom.isValid() &amp;&amp; absTo.isValid()) {
            const intv = this.getInterval();

            const minAggregationInterval = intv.getMinAggregationInterval(absFrom, absTo);
            const maxAggregationInterval = absTo - absFrom;
            aggregationOptions = Object.entries(this.aggregationIntervalTypes)
                .filter(([key, entry]) =&gt; !entry.duration || (entry.duration &gt;= minAggregationInterval &amp;&amp; entry.duration &lt;= maxAggregationInterval))
                .map(([key, entry]) =&gt; ({key, label: entry.label}));
        } else {
            aggregationOptions = Object.entries(this.aggregationIntervalTypes).map(([key, entry]) =&gt; ({key, label: entry.label}));
        }

        return aggregationOptions;
    }

    renderRangePicker() {
        const t = this.props.t;

        const refreshOptions = Object.entries(this.refreshIntervalTypes).map(([key, entry]) =&gt; ({key, label: entry.label}));

        const selectedKey = this.getFormValue(&apos;from&apos;) + &apos; to &apos; + this.getFormValue(&apos;to&apos;);
        const getQuickRanges = column =&gt; {
            return this.fixedRangeTypes[column].map(entry =&gt; {
                const key = entry.from + &apos; to &apos; + entry.to;
                return (
                    &lt;div key={key} className={styles.quickRange + (key === selectedKey ? &apos; &apos; + styles.quickRangeActive : &apos;&apos;)}&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.submitRange(entry)}&gt;{entry.label}&lt;/ActionLink&gt;
                    &lt;/div&gt;
                );
            });
        };

        const parseDate = (str, end) =&gt; {
            const date = dateMath.parse(str, end);
            if (date &amp;&amp; date.isValid()) {
                return date.toDate();
            } else {
                return null;
            }
        };


        return (
            &lt;div className={styles.widget}&gt;
                &lt;div className={styles.timeRange}&gt;
                    &lt;h3&gt;{t(&apos;Custom Time Range&apos;)}&lt;/h3&gt;
                    &lt;Form stateOwner={this} onSubmitAsync={::this.submitForm} format=&quot;wide&quot;&gt;
                        &lt;DatePicker
                            id=&quot;from&quot;
                            label={t(&apos;From:&apos;)}
                            formatDate={date =&gt; moment.utc(date).format(&apos;YYYY-MM-DD&apos;) + &apos; 00:00:00&apos;}
                            parseDate={str =&gt; parseDate(str, false)} format=&quot;wide&quot;
                        /&gt;
                        &lt;DatePicker
                            id=&quot;to&quot;
                            label={t(&apos;To:&apos;)}
                            formatDate={date =&gt; moment.utc(date).format(&apos;YYYY-MM-DD&apos;) + &apos; 23:59:59&apos;}
                            parseDate={str =&gt; parseDate(str, true)} format=&quot;wide&quot;
                        /&gt;
                        &lt;Dropdown id=&quot;aggregationInterval&quot; label=&quot;Aggregation by:&quot; format=&quot;wide&quot; options={this.getAggregationOptions(this.getFormValue(&apos;from&apos;), this.getFormValue(&apos;to&apos;))} /&gt;
                        &lt;div className={styles.refreshApplyRow}&gt;
                            &lt;div className={styles.refreshField}&gt;
                                &lt;Dropdown id=&quot;refreshInterval&quot; label=&quot;Refreshing every:&quot; format=&quot;wide&quot; options={refreshOptions} /&gt;
                            &lt;/div&gt;
                            &lt;div className={styles.applyButton}&gt;
                                &lt;Button type=&quot;submit&quot; className=&quot;btn-primary&quot; label={t(&apos;Apply&apos;)}/&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/Form&gt;
                &lt;/div&gt;

                &lt;div className={styles.separator}/&gt;

                &lt;div className={styles.quickRanges}&gt;
                    &lt;h3&gt;{t(&apos;Quick Ranges&apos;)}&lt;/h3&gt;
                    &lt;div className={styles.quickRangesColumns}&gt;
                        &lt;div className={styles.quickRangesColumns}&gt;
                            &lt;div className={styles.quickRangesColumn}&gt;
                                {getQuickRanges(0)}
                            &lt;/div&gt;
                            &lt;div className={styles.quickRangesColumn}&gt;
                                {getQuickRanges(1)}
                            &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div className={styles.quickRangesColumns}&gt;
                            &lt;div className={styles.quickRangesColumn}&gt;
                                {getQuickRanges(2)}
                            &lt;/div&gt;
                            &lt;div className={styles.quickRangesColumn}&gt;
                                {getQuickRanges(3)}
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        );
    }

    render() {
        const t = this.props.t;

        // FIXME:
        // - add timezone selection
        return (
            &lt;div className=&quot;card&quot;&gt;
                &lt;div className=&quot;card-header&quot; onClick={() =&gt; this.setState({ opened: !this.state.opened })}&gt;
                    &lt;div className={styles.headingDescription}&gt;{this.getDescription()}&lt;/div&gt;
                    &lt;div className={styles.headingButtons}&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.setState({ opened: !this.state.opened })}&gt;&lt;Icon icon=&quot;sliders-h&quot; title={t(&apos;Open time settings&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.getInterval().goBack()}&gt;&lt;Icon icon=&quot;chevron-left&quot; title={t(&apos;Go back&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.getInterval().goForward()}&gt;&lt;Icon icon=&quot;chevron-right&quot; title={t(&apos;Go forward&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.getInterval().refresh()}&gt;&lt;Icon icon=&quot;redo&quot; title={t(&apos;Refresh&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.zoom(0.5)}&gt;&lt;Icon icon=&quot;search-plus&quot; title={t(&apos;Zoom in&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.zoom(2)}&gt;&lt;Icon icon=&quot;search-minus&quot; title={t(&apos;Zoom out&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.move(-0.8)}&gt;&lt;Icon icon=&quot;arrow-left&quot; title={t(&apos;Move left&apos;)}/&gt;&lt;/ActionLink&gt;
                        &lt;ActionLink onClickAsync={async () =&gt; this.move(0.8)}&gt;&lt;Icon icon=&quot;arrow-right&quot; title={t(&apos;Move right&apos;)}/&gt;&lt;/ActionLink&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                { this.state.opened &amp;&amp;
                    &lt;div className=&quot;card-body&quot;&gt;
                        {this.renderRangePicker()}
                    &lt;/div&gt;
                }
            &lt;/div&gt;
        )
    }
}

@withComponentMixins([
    intervalAccessMixin()
])
export class PredefTimeRangeSelector extends Component {
    constructor(props, context) {
        super(props, context);
    }

    static propTypes = {
        ranges: PropTypes.array.isRequired
    }

    submitRange(entry) {
        const spec = new IntervalSpec(
            entry.from,
            entry.to,
            entry.aggregationInterval,
            entry.refreshInterval
        );

        this.getInterval().setSpec(spec);
    }

    render() {
        const intervalSpec = this.getIntervalSpec();
        const selectedKey = intervalSpec.from + &apos; to &apos; + intervalSpec.to;

        const fixedRanges = this.props.ranges.map(entry =&gt; {
            const key = entry.from + &apos; to &apos; + entry.to;
            return (
                &lt;li key={key} className=&quot;nav-item&quot;&gt;
                    &lt;ActionLink className={(key === selectedKey ? &apos;nav-link active&apos; : &apos;nav-link&apos;)} onClickAsync={async () =&gt; this.submitRange(entry)}&gt;{entry.label}&lt;/ActionLink&gt;
                &lt;/li&gt;
            );
        });

        return (
            &lt;ul className=&quot;nav nav-pills&quot;&gt;
                {fixedRanges}
            &lt;/ul&gt;
        )
    }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
